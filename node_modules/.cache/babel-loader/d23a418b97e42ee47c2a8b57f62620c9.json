{"ast":null,"code":"var _jsxFileName = \"/home/nhatnt/TN/FEcoffee/src/client/components/app-context/DetailProvider.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useContext, createContext, useState, useMemo, useEffect } from 'react';\nimport { v4 } from 'uuid';\nimport { useCart } from './CartProvider';\nimport { SERVER_URL } from '../../../constants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DetailContext = /*#__PURE__*/createContext();\nexport const useDetail = () => {\n  _s();\n\n  return useContext(DetailContext);\n};\n\n_s(useDetail, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nfunction DetaiProvider({\n  children\n}) {\n  _s2();\n\n  const {\n    selectedProduct\n  } = useCart();\n  const [detail, setDetail] = useState();\n  const [detailLoading, setDetailLoading] = useState(false);\n  const [priceBySize, setPriceBySize] = useState(0);\n  const [toppingsTotal, setToppingsTotal] = useState(0);\n  const [quantity, setQuantity] = useState(1);\n  const [total, setTotal] = useState(0);\n  const {\n    addCartItems\n  } = useCart();\n  const item = useMemo(() => {\n    if (selectedProduct.id > 0) {\n      return {\n        id: 0,\n        product: {\n          id: selectedProduct.id,\n          name: selectedProduct.name\n        },\n        size: {\n          id: 2,\n          name: 'Medium'\n        },\n        quantity: 1,\n        note: '',\n        toppings: [],\n        price: 0,\n        toppingsTotal: 0,\n        total: 0\n      };\n    }\n  }, [selectedProduct]);\n  useMemo(() => {\n    setDetailLoading(true);\n    fetch(SERVER_URL + `/product/${selectedProduct.id}`).then(response => response.json()).then(setDetail).then(() => setDetailLoading(false));\n  }, [selectedProduct.id]);\n  useEffect(() => {\n    if (detail !== undefined) {\n      setPriceBySize(detail.price); // set original price for calculating\n    }\n  }, [detail]);\n\n  const getQuantity = qty => {\n    setQuantity(qty);\n  };\n\n  const getToppings = checkedValues => {\n    item.toppings = detail.toppings.filter(topping => checkedValues.indexOf(topping.id) !== -1);\n  };\n\n  const getNote = event => {\n    item.note = event.target.value;\n  };\n\n  const prepareToAddItem = () => {\n    item.id = v4(); // for display items in cart, it needs unique value for deleting exactly item in cart (localStorage)\n\n    item.product.id = detail.id;\n    item.product.name = detail.name;\n    item.quantity = quantity;\n    item.price = priceBySize;\n    item.toppingsTotal = toppingsTotal;\n    item.total = total;\n    addCartItems(item);\n  };\n\n  const calculatePriceBySize = value => {\n    if (value === 'Large') {\n      // ***Note: toFixed converts float to string, you have to convert it back to float to use it later (calculate total)\n      setPriceBySize(parseFloat((detail.price + detail.price * 30 / 100).toFixed(2)));\n      item.size.id = 1;\n      item.size.name = 'Large';\n    }\n\n    if (value === 'Small') {\n      setPriceBySize(parseFloat((detail.price - detail.price * 30 / 100).toFixed(2)));\n      item.size.id = 3;\n      item.size.name = 'Small';\n    }\n\n    if (value === 'Medium') {\n      setPriceBySize(detail.price);\n      item.size.id = 2;\n      item.size.name = 'Medium';\n    }\n  };\n\n  const calculateToppingsTotal = (event, price) => {\n    if (event.target.checked) {\n      setToppingsTotal(parseFloat((toppingsTotal + price).toFixed(2)));\n    } else {\n      setToppingsTotal(parseFloat((toppingsTotal - price).toFixed(2)));\n    }\n  };\n\n  useEffect(() => {\n    if (selectedProduct.id > 0) {\n      setTotal(parseFloat(((priceBySize + toppingsTotal) * quantity).toFixed(2)));\n    }\n  }, [selectedProduct.id, priceBySize, toppingsTotal, quantity]);\n  return /*#__PURE__*/_jsxDEV(DetailContext.Provider, {\n    value: {\n      detail,\n      detailLoading,\n      priceBySize,\n      toppingsTotal,\n      total,\n      prepareToAddItem,\n      calculatePriceBySize,\n      calculateToppingsTotal,\n      getQuantity,\n      getToppings,\n      getNote\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 3\n  }, this);\n}\n\n_s2(DetaiProvider, \"ZFnv6SiqnEQ03/r8GEu14z0ya2Q=\", false, function () {\n  return [useCart, useCart];\n});\n\n_c = DetaiProvider;\nexport default DetaiProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"DetaiProvider\");","map":{"version":3,"sources":["/home/nhatnt/TN/FEcoffee/src/client/components/app-context/DetailProvider.jsx"],"names":["useContext","createContext","useState","useMemo","useEffect","v4","useCart","SERVER_URL","DetailContext","useDetail","DetaiProvider","children","selectedProduct","detail","setDetail","detailLoading","setDetailLoading","priceBySize","setPriceBySize","toppingsTotal","setToppingsTotal","quantity","setQuantity","total","setTotal","addCartItems","item","id","product","name","size","note","toppings","price","fetch","then","response","json","undefined","getQuantity","qty","getToppings","checkedValues","filter","topping","indexOf","getNote","event","target","value","prepareToAddItem","calculatePriceBySize","parseFloat","toFixed","calculateToppingsTotal","checked"],"mappings":"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","sourcesContent":["import { useContext, createContext, useState, useMemo, useEffect } from 'react';\nimport { v4 } from 'uuid';\nimport { useCart } from './CartProvider';\nimport { SERVER_URL } from '../../../constants';\n\nconst DetailContext = createContext();\nexport const useDetail = () => useContext(DetailContext);\n\nfunction DetaiProvider({ children }) {\n\tconst { selectedProduct } = useCart();\n\tconst [detail, setDetail] = useState();\n\tconst [detailLoading, setDetailLoading] = useState(false);\n\tconst [priceBySize, setPriceBySize] = useState(0);\n\tconst [toppingsTotal, setToppingsTotal] = useState(0);\n\tconst [quantity, setQuantity] = useState(1);\n\tconst [total, setTotal] = useState(0);\n\tconst { addCartItems } = useCart();\n\n\tconst item = useMemo(() => {\n\t\tif (selectedProduct.id > 0) {\n\t\t\treturn {\n\t\t\t\tid: 0,\n\t\t\t\tproduct: { id: selectedProduct.id, name: selectedProduct.name },\n\t\t\t\tsize: { id: 2, name: 'Medium' },\n\t\t\t\tquantity: 1,\n\t\t\t\tnote: '',\n\t\t\t\ttoppings: [],\n\t\t\t\tprice: 0,\n\t\t\t\ttoppingsTotal: 0,\n\t\t\t\ttotal: 0,\n\t\t\t};\n\t\t}\n\t}, [selectedProduct]);\n\n\tuseMemo(() => {\n\t\tsetDetailLoading(true);\n\t\tfetch(SERVER_URL + `/product/${selectedProduct.id}`)\n\t\t\t.then((response) => response.json())\n\t\t\t.then(setDetail)\n\t\t\t.then(() => setDetailLoading(false));\n\t}, [selectedProduct.id]);\n\n\tuseEffect(() => {\n\t\tif (detail !== undefined) {\n\t\t\tsetPriceBySize(detail.price); // set original price for calculating\n\t\t}\n\t}, [detail]);\n\n\tconst getQuantity = (qty) => {\n\t\tsetQuantity(qty);\n\t};\n\n\tconst getToppings = (checkedValues) => {\n\t\titem.toppings = detail.toppings.filter((topping) => checkedValues.indexOf(topping.id) !== -1);\n\t};\n\n\tconst getNote = (event) => {\n\t\titem.note = event.target.value;\n\t};\n\n\tconst prepareToAddItem = () => {\n\t\titem.id = v4(); // for display items in cart, it needs unique value for deleting exactly item in cart (localStorage)\n\t\titem.product.id = detail.id;\n\t\titem.product.name = detail.name;\n\t\titem.quantity = quantity;\n\t\titem.price = priceBySize;\n\t\titem.toppingsTotal = toppingsTotal;\n\t\titem.total = total;\n\t\taddCartItems(item);\n\t};\n\n\tconst calculatePriceBySize = (value) => {\n\t\tif (value === 'Large') {\n\t\t\t// ***Note: toFixed converts float to string, you have to convert it back to float to use it later (calculate total)\n\t\t\tsetPriceBySize(parseFloat((detail.price + (detail.price * 30) / 100).toFixed(2)));\n\t\t\titem.size.id = 1;\n\t\t\titem.size.name = 'Large';\n\t\t}\n\t\tif (value === 'Small') {\n\t\t\tsetPriceBySize(parseFloat((detail.price - (detail.price * 30) / 100).toFixed(2)));\n\t\t\titem.size.id = 3;\n\t\t\titem.size.name = 'Small';\n\t\t}\n\t\tif (value === 'Medium') {\n\t\t\tsetPriceBySize(detail.price);\n\t\t\titem.size.id = 2;\n\t\t\titem.size.name = 'Medium';\n\t\t}\n\t};\n\n\tconst calculateToppingsTotal = (event, price) => {\n\t\tif (event.target.checked) {\n\t\t\tsetToppingsTotal(parseFloat((toppingsTotal + price).toFixed(2)));\n\t\t} else {\n\t\t\tsetToppingsTotal(parseFloat((toppingsTotal - price).toFixed(2)));\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tif (selectedProduct.id > 0) {\n\t\t\tsetTotal(parseFloat(((priceBySize + toppingsTotal) * quantity).toFixed(2)));\n\t\t}\n\t}, [selectedProduct.id, priceBySize, toppingsTotal, quantity]);\n\n\treturn (\n\t\t<DetailContext.Provider\n\t\t\tvalue={{\n\t\t\t\tdetail,\n\t\t\t\tdetailLoading,\n\t\t\t\tpriceBySize,\n\t\t\t\ttoppingsTotal,\n\t\t\t\ttotal,\n\t\t\t\tprepareToAddItem,\n\t\t\t\tcalculatePriceBySize,\n\t\t\t\tcalculateToppingsTotal,\n\t\t\t\tgetQuantity,\n\t\t\t\tgetToppings,\n\t\t\t\tgetNote,\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</DetailContext.Provider>\n\t);\n}\n\nexport default DetaiProvider;\n"]},"metadata":{},"sourceType":"module"}